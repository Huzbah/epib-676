<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.37">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="YOUR NAME HERE">
<meta name="dcterms.date" content="2022-10-26">

<title>Assignment 1: Decision trees and cost-effectiveness</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="assign1_trees_cea_files/libs/clipboard/clipboard.min.js"></script>
<script src="assign1_trees_cea_files/libs/quarto-html/quarto.js"></script>
<script src="assign1_trees_cea_files/libs/quarto-html/popper.min.js"></script>
<script src="assign1_trees_cea_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="assign1_trees_cea_files/libs/quarto-html/anchor.min.js"></script>
<link href="assign1_trees_cea_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="assign1_trees_cea_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="assign1_trees_cea_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="assign1_trees_cea_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="assign1_trees_cea_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="assign1_trees_cea_files/libs/tabwid-1.1.0/tabwid.css" rel="stylesheet">
<link href="assign1_trees_cea_files/libs/tabwid-1.1.0/scrool.css" rel="stylesheet">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#section-1-decision-trees" id="toc-section-1-decision-trees" class="nav-link active" data-scroll-target="#section-1-decision-trees">Section 1: Decision trees</a>
  <ul class="collapse">
  <li><a href="#a-expected-value-calculations" id="toc-a-expected-value-calculations" class="nav-link" data-scroll-target="#a-expected-value-calculations">1a Expected value calculations</a></li>
  <li><a href="#b-build-peptic-ulcer-closure-decision-model" id="toc-b-build-peptic-ulcer-closure-decision-model" class="nav-link" data-scroll-target="#b-build-peptic-ulcer-closure-decision-model">1b Build peptic ulcer closure decision model</a></li>
  </ul></li>
  <li><a href="#section-2-economic-evaluation" id="toc-section-2-economic-evaluation" class="nav-link" data-scroll-target="#section-2-economic-evaluation">Section 2: Economic evaluation</a>
  <ul class="collapse">
  <li><a href="#a-discounting" id="toc-a-discounting" class="nav-link" data-scroll-target="#a-discounting">2a Discounting</a></li>
  <li><a href="#b-incremental-analysis" id="toc-b-incremental-analysis" class="nav-link" data-scroll-target="#b-incremental-analysis">2b Incremental analysis</a></li>
  <li><a href="#identifying-maximum-net-monetary-benefit" id="toc-identifying-maximum-net-monetary-benefit" class="nav-link" data-scroll-target="#identifying-maximum-net-monetary-benefit">Identifying maximum net monetary benefit</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Assignment 1: Decision trees and cost-effectiveness</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>YOUR NAME HERE </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 26, 2022</p>
    </div>
  </div>
    
  </div>
  

</header>

<section id="section-1-decision-trees" class="level1">
<h1>Section 1: Decision trees</h1>
<p>We’ll use the <a href="https://cran.r-project.org/web/packages/rdecision/index.html">rdecision package</a> to develop and visualize decision trees. There are multiple vignettes on the CRAN page; <a href="https://cran.rstudio.com/web/packages/rdecision/vignettes/DT00-DecisionTreeTutorial.html">this introductory one</a> will probably be sufficient.</p>
<section id="a-expected-value-calculations" class="level2">
<h2 class="anchored" data-anchor-id="a-expected-value-calculations">1a Expected value calculations</h2>
<p>To help you use the package and make sure you understand the way to calculate the expected value, I’ll first make a simple tree, visualize it, and “roll it back”</p>
<p>Just review and run this code; you don’t have to change anything.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("rdecision") #uncomment and run once if you haven't installed it</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rdecision)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(flextable)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Decision problem: Diet or excercise to reduce chance of needing a stent: which is cost-saving?</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameters</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>c_diet <span class="ot">&lt;-</span> <span class="dv">50</span> <span class="co">#cost of diet</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>c_excercise <span class="ot">&lt;-</span> <span class="dv">750</span> <span class="co">#cost of exercise</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>c_stent <span class="ot">&lt;-</span> <span class="dv">5000</span> <span class="co">#cost of a stent</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>u_stent <span class="ot">&lt;-</span> <span class="fl">0.75</span> <span class="co">#utility of a stent (relative to 1.0)</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>p_stent_diet <span class="ot">&lt;-</span> (<span class="dv">68</span> <span class="sc">-</span> <span class="dv">12</span>)<span class="sc">/</span><span class="dv">68</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>p_stent_exercise <span class="ot">&lt;-</span> (<span class="dv">58</span> <span class="sc">-</span> <span class="dv">18</span>)<span class="sc">/</span><span class="dv">58</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co">#Model using rdecision package</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co">#Create decision and chance nodes</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>decision_node <span class="ot">&lt;-</span> DecisionNode<span class="sc">$</span><span class="fu">new</span>(<span class="st">"Diet or excercise"</span>)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>chance_node_diet <span class="ot">&lt;-</span> ChanceNode<span class="sc">$</span><span class="fu">new</span>(<span class="st">"Stent?"</span>)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>chance_node_exercise <span class="ot">&lt;-</span> ChanceNode<span class="sc">$</span><span class="fu">new</span>(<span class="st">"Stent?"</span>)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="co">#Create leaf nodes</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>leaf_node_diet_no_stent <span class="ot">&lt;-</span> LeafNode<span class="sc">$</span><span class="fu">new</span>(<span class="st">"No stent"</span>)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>leaf_node_diet_stent <span class="ot">&lt;-</span> LeafNode<span class="sc">$</span><span class="fu">new</span>(<span class="st">"Stent"</span>, <span class="at">utility =</span> u_stent)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>leaf_node_exercise_no_stent <span class="ot">&lt;-</span> LeafNode<span class="sc">$</span><span class="fu">new</span>(<span class="st">"No stent"</span>)</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>leaf_node_exercise_stent <span class="ot">&lt;-</span> LeafNode<span class="sc">$</span><span class="fu">new</span>(<span class="st">"Stent"</span>, <span class="at">utility =</span> u_stent)</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="co">#Create 'actions', paths from your decision node(s)</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>action_diet <span class="ot">&lt;-</span> Action<span class="sc">$</span><span class="fu">new</span>(</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>  decision_node, chance_node_diet, <span class="at">cost =</span> c_diet, <span class="at">label =</span> <span class="st">"Diet"</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>action_exercise <span class="ot">&lt;-</span> Action<span class="sc">$</span><span class="fu">new</span>(</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>  decision_node, chance_node_exercise, <span class="at">cost =</span> c_excercise, <span class="at">label =</span> <span class="st">"Exercise"</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a><span class="co">#Create 'reactions', paths from your chance node(s)</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>reaction_diet_success <span class="ot">&lt;-</span> Reaction<span class="sc">$</span><span class="fu">new</span>(</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>  chance_node_diet, leaf_node_diet_no_stent, </span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>  <span class="at">p =</span> <span class="dv">1</span><span class="sc">-</span>p_stent_diet, <span class="at">cost =</span> <span class="fl">0.0</span>, <span class="at">label =</span> <span class="st">"Did not need stent"</span>)</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>reaction_diet_failure <span class="ot">&lt;-</span> Reaction<span class="sc">$</span><span class="fu">new</span>(</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>  chance_node_diet, leaf_node_diet_stent, </span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>  <span class="at">p =</span> p_stent_diet, <span class="at">cost =</span> c_stent, <span class="at">label =</span> <span class="st">"Needed stent"</span>)</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>reaction_exercise_success <span class="ot">&lt;-</span> Reaction<span class="sc">$</span><span class="fu">new</span>(</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>  chance_node_exercise, leaf_node_exercise_no_stent, </span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>  <span class="at">p =</span> <span class="dv">1</span><span class="sc">-</span>p_stent_exercise, <span class="at">cost =</span> <span class="fl">0.0</span>, <span class="at">label =</span> <span class="st">"Did not need stent"</span>)</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>reaction_exercise_failure <span class="ot">&lt;-</span> Reaction<span class="sc">$</span><span class="fu">new</span>(</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>  chance_node_exercise, leaf_node_exercise_stent, </span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>  <span class="at">p =</span> p_stent_exercise, <span class="at">cost =</span> <span class="fl">5000.0</span>, <span class="at">label =</span> <span class="st">"Needed stent"</span>)</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a><span class="co">#Create, draw, and evaluate the tree</span></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>DT1 <span class="ot">&lt;-</span> DecisionTree<span class="sc">$</span><span class="fu">new</span>(</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>  <span class="at">V =</span> <span class="fu">list</span>(decision_node, <span class="co">#verticies (nodes)</span></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>           chance_node_diet, </span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>           chance_node_exercise, </span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>           leaf_node_diet_no_stent, </span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>           leaf_node_diet_stent, </span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>           leaf_node_exercise_no_stent, </span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>           leaf_node_exercise_stent),</span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>  <span class="at">E =</span> <span class="fu">list</span>(action_diet, <span class="co">#edges</span></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>           action_exercise,</span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>           reaction_diet_success,</span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>           reaction_diet_failure,</span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>           reaction_exercise_success,</span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>           reaction_exercise_failure)</span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>DT1<span class="sc">$</span><span class="fu">draw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="assign1_trees_cea_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>DT1_evaluation <span class="ot">&lt;-</span> DT1<span class="sc">$</span><span class="fu">evaluate</span>()</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>DT1_evaluation <span class="sc">|&gt;</span> <span class="fu">flextable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="tabwid"><style>.cl-e58061fc{}.cl-e57a506e{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-e57d2bea{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-e57d2bf4{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-e57d3c2a{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e57d3c2b{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e57d3c34{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e57d3c35{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e57d3c3e{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e57d3c3f{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table class="cl-e58061fc"><thead><tr style="overflow-wrap:break-word;"><td class="cl-e57d3c2a"><p class="cl-e57d2bea"><span class="cl-e57a506e">Diet.or.excercise</span></p></td><td class="cl-e57d3c2b"><p class="cl-e57d2bf4"><span class="cl-e57a506e">Run</span></p></td><td class="cl-e57d3c2b"><p class="cl-e57d2bf4"><span class="cl-e57a506e">Probability</span></p></td><td class="cl-e57d3c2b"><p class="cl-e57d2bf4"><span class="cl-e57a506e">Cost</span></p></td><td class="cl-e57d3c2b"><p class="cl-e57d2bf4"><span class="cl-e57a506e">Benefit</span></p></td><td class="cl-e57d3c2b"><p class="cl-e57d2bf4"><span class="cl-e57a506e">Utility</span></p></td><td class="cl-e57d3c2b"><p class="cl-e57d2bf4"><span class="cl-e57a506e">QALY</span></p></td></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-e57d3c34"><p class="cl-e57d2bea"><span class="cl-e57a506e">Diet</span></p></td><td class="cl-e57d3c35"><p class="cl-e57d2bf4"><span class="cl-e57a506e">1</span></p></td><td class="cl-e57d3c35"><p class="cl-e57d2bf4"><span class="cl-e57a506e">1</span></p></td><td class="cl-e57d3c35"><p class="cl-e57d2bf4"><span class="cl-e57a506e">4,167.647</span></p></td><td class="cl-e57d3c35"><p class="cl-e57d2bf4"><span class="cl-e57a506e">0</span></p></td><td class="cl-e57d3c35"><p class="cl-e57d2bf4"><span class="cl-e57a506e">0.7941176</span></p></td><td class="cl-e57d3c35"><p class="cl-e57d2bf4"><span class="cl-e57a506e">0.7941176</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e57d3c3e"><p class="cl-e57d2bea"><span class="cl-e57a506e">Exercise</span></p></td><td class="cl-e57d3c3f"><p class="cl-e57d2bf4"><span class="cl-e57a506e">1</span></p></td><td class="cl-e57d3c3f"><p class="cl-e57d2bf4"><span class="cl-e57a506e">1</span></p></td><td class="cl-e57d3c3f"><p class="cl-e57d2bf4"><span class="cl-e57a506e">4,198.276</span></p></td><td class="cl-e57d3c3f"><p class="cl-e57d2bf4"><span class="cl-e57a506e">0</span></p></td><td class="cl-e57d3c3f"><p class="cl-e57d2bf4"><span class="cl-e57a506e">0.8275862</span></p></td><td class="cl-e57d3c3f"><p class="cl-e57d2bf4"><span class="cl-e57a506e">0.8275862</span></p></td></tr></tbody></table></div>
</div>
</div>
<p>In the code chunk below, using the variables defined in the last code chunk (e.g., <code>p_stent_diet</code>), calculate the expected utility and expected cost of the diet arm without the <code>rdecision</code> package (simple summing/multiplying).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>expected_cost_diet <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>expected_utility_diet <span class="ot">&lt;-</span> <span class="cn">NA</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="b-build-peptic-ulcer-closure-decision-model" class="level2">
<h2 class="anchored" data-anchor-id="b-build-peptic-ulcer-closure-decision-model">1b Build peptic ulcer closure decision model</h2>
<p>You will now develop a decision analysis to help determine whether a newer clip should be used to close bleeding peptic ulcers in the gastrointestinal tract during an upper GI encoscopy, or EGD (stands for esophagogastroduodenoscopy). The newer clips are called over-the-scope clips, abbreviated OTSc or OTS clip. Randomized trial data show that rebleeding rates are lower following endoscopic closure with OTSc as compared to when standard therapy clips are used, but OTSc are significantly more expensive. You will build a decision tree to determine whether OTSc are ‘worth’ the added expense, either as a first line therapy (i.e.&nbsp;to treat all peptic ulcer bleeds initially) or only for rebleeds (i.e.&nbsp;only if a standard therapy clip failed, resulting in a ‘rebleed’).</p>
<p>We assume all peptic ulcer bleeds are fully resolved during a short hospitalization and therefore our analysis uses a time horizon of only 30 days. No discounting is needed due to the short time horizon. Because this analysis involves very small differences in utility, our parameters are in quality-adjusted life days (QALDs) instead of quality-adjusted life years (QALYs); 1 QALD = 1/365 QALY.</p>
<p>All model parameters are provided for you in the file <code>parameters_OTSc.xlsx</code>, feel free to open it to take a look. For your assignment to render without error, this .csv file must be in the same folder as the assignment .qmd file. This chunk of code reads in the .csv file and generates a parameter table, using the flextable package for formatting (you don’t have to do anything in this code chunk).</p>
<p>NOTE: You might need to close the Excel file for the read_excel function to run properly.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl) <span class="co">#read in excel files; install it if you don't have it using install.packages("readxl")</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(flextable) <span class="co">#formatting tables for display (https://davidgohel.github.io/flextable/reference/index.html)</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co">#read table from Excel</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>t_params <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">'params_assign1.xlsx'</span>, <span class="at">sheet =</span> <span class="st">"OTSc"</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Display it nicely</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>t_params <span class="sc">|&gt;</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flextable</span>() <span class="sc">|&gt;</span> <span class="co">#turn into flextable object</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">merge_v</span>(<span class="at">j=</span><span class="dv">1</span>) <span class="sc">|&gt;</span> <span class="co">#Merge cells in first column with same value (group probabilities, costs, etc.)</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_box</span>() <span class="sc">|&gt;</span> <span class="co">#Apply a theme for aesthetics</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autofit</span>() <span class="co">#automatically set column widths to reasonable values</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="tabwid"><style>.cl-e5d6a35a{}.cl-e5d0e302{font-family:'Helvetica';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-e5d0e316{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-e5d2f656{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-e5d2f660{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-e5d303da{width:3.028in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e5d303db{width:1.364in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e5d303e4{width:10.416in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e5d303ee{width:1.058in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e5d303ef{width:1.236in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e5d303f0{width:1.261in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e5d303f8{width:3.028in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e5d303f9{width:1.364in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e5d30402{width:10.416in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e5d30403{width:1.058in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e5d3040c{width:1.236in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e5d3040d{width:1.261in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e5d3040e{width:3.028in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e5d30416{width:1.364in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e5d30417{width:10.416in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e5d30418{width:1.058in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e5d30420{width:1.236in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e5d30421{width:1.261in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e5d30422{width:3.028in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e5d3042a{width:1.364in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e5d3042b{width:10.416in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e5d30434{width:1.058in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e5d30435{width:1.236in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e5d30436{width:1.261in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e5d3043e{width:3.028in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e5d30448{width:1.364in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e5d30449{width:10.416in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e5d3044a{width:1.058in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e5d30452{width:1.236in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e5d30453{width:1.261in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e5d3045c{width:3.028in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e5d3045d{width:1.364in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e5d3045e{width:10.416in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e5d30466{width:1.058in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e5d30467{width:1.236in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e5d30468{width:1.261in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table class="cl-e5d6a35a"><thead><tr style="overflow-wrap:break-word;"><td class="cl-e5d303da"><p class="cl-e5d2f656"><span class="cl-e5d0e302">category</span></p></td><td class="cl-e5d303db"><p class="cl-e5d2f656"><span class="cl-e5d0e302">name</span></p></td><td class="cl-e5d303e4"><p class="cl-e5d2f656"><span class="cl-e5d0e302">description</span></p></td><td class="cl-e5d303ee"><p class="cl-e5d2f660"><span class="cl-e5d0e302">base_case</span></p></td><td class="cl-e5d303ef"><p class="cl-e5d2f660"><span class="cl-e5d0e302">lower_bound</span></p></td><td class="cl-e5d303f0"><p class="cl-e5d2f660"><span class="cl-e5d0e302">upper_bound</span></p></td></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td rowspan="4" class="cl-e5d303f8"><p class="cl-e5d2f656"><span class="cl-e5d0e316">Probability</span></p></td><td class="cl-e5d303f9"><p class="cl-e5d2f656"><span class="cl-e5d0e316">p_ST_rebleed</span></p></td><td class="cl-e5d30402"><p class="cl-e5d2f656"><span class="cl-e5d0e316">Continued bleding after an initial EGD using standard therapy</span></p></td><td class="cl-e5d30403"><p class="cl-e5d2f660"><span class="cl-e5d0e316">0.110</span></p></td><td class="cl-e5d3040c"><p class="cl-e5d2f660"><span class="cl-e5d0e316">0.080</span></p></td><td class="cl-e5d3040d"><p class="cl-e5d2f660"><span class="cl-e5d0e316">0.140</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e5d30416"><p class="cl-e5d2f656"><span class="cl-e5d0e316">p_OTS_rebleed</span></p></td><td class="cl-e5d30417"><p class="cl-e5d2f656"><span class="cl-e5d0e316">Continued bleding after an initial EGD using OTS clip</span></p></td><td class="cl-e5d30418"><p class="cl-e5d2f660"><span class="cl-e5d0e316">0.053</span></p></td><td class="cl-e5d30420"><p class="cl-e5d2f660"><span class="cl-e5d0e316">0.007</span></p></td><td class="cl-e5d30421"><p class="cl-e5d2f660"><span class="cl-e5d0e316">0.090</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e5d30416"><p class="cl-e5d2f656"><span class="cl-e5d0e316">p_ST_rpt_IR</span></p></td><td class="cl-e5d30417"><p class="cl-e5d2f656"><span class="cl-e5d0e316">Interventional Radiology (IR) procedure after repeat EGD using standard therapy</span></p></td><td class="cl-e5d30418"><p class="cl-e5d2f660"><span class="cl-e5d0e316">0.576</span></p></td><td class="cl-e5d30420"><p class="cl-e5d2f660"><span class="cl-e5d0e316">0.390</span></p></td><td class="cl-e5d30421"><p class="cl-e5d2f660"><span class="cl-e5d0e316">0.760</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e5d30416"><p class="cl-e5d2f656"><span class="cl-e5d0e316">p_OTS_rpt_IR</span></p></td><td class="cl-e5d30417"><p class="cl-e5d2f656"><span class="cl-e5d0e316">Interventional Radiology (IR) procedure after repeat  EGD using OTS clip</span></p></td><td class="cl-e5d30418"><p class="cl-e5d2f660"><span class="cl-e5d0e316">0.152</span></p></td><td class="cl-e5d30420"><p class="cl-e5d2f660"><span class="cl-e5d0e316">0.030</span></p></td><td class="cl-e5d30421"><p class="cl-e5d2f660"><span class="cl-e5d0e316">0.270</span></p></td></tr><tr style="overflow-wrap:break-word;"><td rowspan="7" class="cl-e5d30422"><p class="cl-e5d2f656"><span class="cl-e5d0e316">Cost</span></p></td><td class="cl-e5d3042a"><p class="cl-e5d2f656"><span class="cl-e5d0e316">c_EGD_MD</span></p></td><td class="cl-e5d3042b"><p class="cl-e5d2f656"><span class="cl-e5d0e316">EGD physician fee (CPT code)</span></p></td><td class="cl-e5d30434"><p class="cl-e5d2f660"><span class="cl-e5d0e316">192.990</span></p></td><td class="cl-e5d30435"><p class="cl-e5d2f660"><span class="cl-e5d0e316">100.000</span></p></td><td class="cl-e5d30436"><p class="cl-e5d2f660"><span class="cl-e5d0e316">1,000.000</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e5d3042a"><p class="cl-e5d2f656"><span class="cl-e5d0e316">c_Stclip</span></p></td><td class="cl-e5d3042b"><p class="cl-e5d2f656"><span class="cl-e5d0e316">Standard therapy clip</span></p></td><td class="cl-e5d30434"><p class="cl-e5d2f660"><span class="cl-e5d0e316">174.000</span></p></td><td class="cl-e5d30435"><p class="cl-e5d2f660"><span class="cl-e5d0e316">50.000</span></p></td><td class="cl-e5d30436"><p class="cl-e5d2f660"><span class="cl-e5d0e316">610.000</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e5d30448"><p class="cl-e5d2f656"><span class="cl-e5d0e316">c_OTS</span></p></td><td class="cl-e5d30449"><p class="cl-e5d2f656"><span class="cl-e5d0e316">Over-the-scope clip</span></p></td><td class="cl-e5d3044a"><p class="cl-e5d2f660"><span class="cl-e5d0e316">438.000</span></p></td><td class="cl-e5d30452"><p class="cl-e5d2f660"><span class="cl-e5d0e316">170.000</span></p></td><td class="cl-e5d30453"><p class="cl-e5d2f660"><span class="cl-e5d0e316">1,000.000</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e5d30416"><p class="cl-e5d2f656"><span class="cl-e5d0e316">c_hosp_noCC</span></p></td><td class="cl-e5d30417"><p class="cl-e5d2f656"><span class="cl-e5d0e316">Hospitalization cost of single successful EGD, based on DRG 379:  GI hemorrhage hospitalization w/o CC</span></p></td><td class="cl-e5d30418"><p class="cl-e5d2f660"><span class="cl-e5d0e316">5,534.110</span></p></td><td class="cl-e5d30420"><p class="cl-e5d2f660"><span class="cl-e5d0e316">2,500.000</span></p></td><td class="cl-e5d30421"><p class="cl-e5d2f660"><span class="cl-e5d0e316">7,500.000</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e5d30416"><p class="cl-e5d2f656"><span class="cl-e5d0e316">c_hosp_CC</span></p></td><td class="cl-e5d30417"><p class="cl-e5d2f656"><span class="cl-e5d0e316">Hospitalization cost of needing two EGDs, based on DRG 377, GI hemorrhage hospitalization w/ CC</span></p></td><td class="cl-e5d30418"><p class="cl-e5d2f660"><span class="cl-e5d0e316">7,503.890</span></p></td><td class="cl-e5d30420"><p class="cl-e5d2f660"><span class="cl-e5d0e316">5,500.000</span></p></td><td class="cl-e5d30421"><p class="cl-e5d2f660"><span class="cl-e5d0e316">13,000.000</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e5d30416"><p class="cl-e5d2f656"><span class="cl-e5d0e316">c_hosp_MCC</span></p></td><td class="cl-e5d30417"><p class="cl-e5d2f656"><span class="cl-e5d0e316">Hospitalization cost of two failed EGDs followed by an interventional radiology procedure, based on, DRG 378, GI hemorrhage hospitalization w/ MCC</span></p></td><td class="cl-e5d30418"><p class="cl-e5d2f660"><span class="cl-e5d0e316">13,097.080</span></p></td><td class="cl-e5d30420"><p class="cl-e5d2f660"><span class="cl-e5d0e316">7,503.890</span></p></td><td class="cl-e5d30421"><p class="cl-e5d2f660"><span class="cl-e5d0e316">25,000.000</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e5d3045d"><p class="cl-e5d2f656"><span class="cl-e5d0e316">c_IR_MD</span></p></td><td class="cl-e5d3045e"><p class="cl-e5d2f656"><span class="cl-e5d0e316">Interventional radiology physician fee</span></p></td><td class="cl-e5d30466"><p class="cl-e5d2f660"><span class="cl-e5d0e316">1,005.310</span></p></td><td class="cl-e5d30467"><p class="cl-e5d2f660"><span class="cl-e5d0e316">200.000</span></p></td><td class="cl-e5d30468"><p class="cl-e5d2f660"><span class="cl-e5d0e316">2,000.000</span></p></td></tr><tr style="overflow-wrap:break-word;"><td rowspan="3" class="cl-e5d3040e"><p class="cl-e5d2f656"><span class="cl-e5d0e316">Utility toll (Quality-adjusted life days lost)</span></p></td><td class="cl-e5d30416"><p class="cl-e5d2f656"><span class="cl-e5d0e316">u_EGD</span></p></td><td class="cl-e5d30417"><p class="cl-e5d2f656"><span class="cl-e5d0e316">Single EGD</span></p></td><td class="cl-e5d30418"><p class="cl-e5d2f660"><span class="cl-e5d0e316">4.745</span></p></td><td class="cl-e5d30420"><p class="cl-e5d2f660"><span class="cl-e5d0e316">0.000</span></p></td><td class="cl-e5d30421"><p class="cl-e5d2f660"><span class="cl-e5d0e316">5.840</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e5d3042a"><p class="cl-e5d2f656"><span class="cl-e5d0e316">u_double_EGD</span></p></td><td class="cl-e5d3042b"><p class="cl-e5d2f656"><span class="cl-e5d0e316">Added toll of second EGD</span></p></td><td class="cl-e5d30434"><p class="cl-e5d2f660"><span class="cl-e5d0e316">1.095</span></p></td><td class="cl-e5d30435"><p class="cl-e5d2f660"><span class="cl-e5d0e316">0.000</span></p></td><td class="cl-e5d30436"><p class="cl-e5d2f660"><span class="cl-e5d0e316">4.745</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e5d3042a"><p class="cl-e5d2f656"><span class="cl-e5d0e316">u_IR</span></p></td><td class="cl-e5d3042b"><p class="cl-e5d2f656"><span class="cl-e5d0e316">Added toll of IR after two EGDs</span></p></td><td class="cl-e5d30434"><p class="cl-e5d2f660"><span class="cl-e5d0e316">3.650</span></p></td><td class="cl-e5d30435"><p class="cl-e5d2f660"><span class="cl-e5d0e316">0.000</span></p></td><td class="cl-e5d30436"><p class="cl-e5d2f660"><span class="cl-e5d0e316">18.615</span></p></td></tr></tbody></table></div>
</div>
</div>
<p>In the code chunk below, build the model using the rdecision package with the ‘base_case’ value for each parameter (we won’t be using the ‘lower_bound’ or ‘upper_bound’ columns for anything in this problem set).</p>
<p>Your model should start with a decision mode with three options:</p>
<ul>
<li><p><strong>OTSc first:</strong> use OTS clip for the initial closure; if a rebleed occurs use a standard clip</p></li>
<li><p><strong>ST first:</strong> use a standard clip for the initial closure; if a rebleed occurs use an OTS clip</p></li>
<li><p><strong>ST only</strong>: use a standard clip for the initial closure and again if a rebleed occurs.</p></li>
</ul>
<p>For all three arms from this decision node (“actions” in rdecision package), you will incur the cost of whichever clip was used first (<code>c_Stclip</code> or <code>c_OTS</code>). For calculating the QALDs experienced over our 30-day time h and the disutility associated with an EGH (<code>u_EGD</code>).</p>
<p>All three arms lead to a chance node with two possibilities:</p>
<ul>
<li><p><strong>Success:</strong> the initial procedure was a success. You incur the cost of a hospitalization without complications or comorbidities (<code>c_hosp_noCC</code>). This is a leaf node (no more chances/decisions)</p></li>
<li><p><strong>Further bleeding; 2nd-line EGD:</strong> The EGD needs to be redone. You incur the cost of whichever clip is used for second-line closure (<code>c_STclip</code> or <code>c_OTS</code>) under that arm, and have additional disutility of <code>u_double_EGD</code>.</p></li>
</ul>
<p>After second-line therapy, you have another chance node with two possibilities:</p>
<ul>
<li><p><strong>Success:</strong> second line therapy worked. You incur the cost of a hospitalization with minor complications and comorbidies (<code>c_hosp_CC</code>). This is a leaf node.</p></li>
<li><p><strong>Further bleeding; IR procedure:</strong> After 2 failed EGDs, patients undergo an interventional radiology procedure. You incur the cost of a hospitalization with major complications and comorbidies plus a physician fee for the interventional radiologist (<code>c_hosp_MCC + c_IR_MD</code>). You also incur additional a disutility associated with the IR procedure <code>u_IR</code>. This is also a leaf node.</p></li>
</ul>
<p>It may be helpful to draw the tree and where the variables are used before you start coding it.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># I like to turn the parameters from my table into  a named list</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Then I can refer to the parameter I want by, e.g., `params$c_OTS`</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>params <span class="ot">&lt;-</span> <span class="fu">as.list</span>(t_params<span class="sc">$</span>base_case)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(params) <span class="ot">&lt;-</span> t_params<span class="sc">$</span>name</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Create decision and chance nodes</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co">#Create leaf nodes</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co">#Create 'actions', paths from your decision node(s)</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co">#Create 'reactions', paths from your chance node(s)</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="co">#Create and draw the tree</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Create table with the expected cost and utility (in QALYs or QALD) of each alternative</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Using a willingness to pay threshold of $50,000 per QALY ($137 per QALD), indicate whether each intervention is dominated with strong dominance, Dominated by extended dominant, not cost-effective, or preferred (exactly one intervention should be preferred).</p>
<blockquote class="blockquote">
<p>ST only:</p>
<p>ST then OTSc:</p>
<p>OTSc then ST:</p>
</blockquote>
<p>In case you’re curious, this is a slightly simplified version of <a href="https://doi.org/10.1016/j.giec.2019.09.004">a paper I published during my PhD</a>.</p>
</section>
</section>
<section id="section-2-economic-evaluation" class="level1">
<h1>Section 2: Economic evaluation</h1>
<section id="a-discounting" class="level2">
<h2 class="anchored" data-anchor-id="a-discounting">2a Discounting</h2>
<p>The vector <code>costs_by_year</code> represents costs by year, starting with year 0 (this year). Calculate the net present cost with an annual discount rate of 2% and of 5%.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>costs_by_year <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">100</span>, <span class="dv">200</span>, <span class="dv">500</span>, <span class="dv">350</span>, <span class="dv">700</span>) <span class="co">#costs 0, 1, 2, 3, and 4 years into the future</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>npc_2percent <span class="ot">&lt;-</span> <span class="cn">NA</span> <span class="co">#Calculate the net present cost with a discount rate of 2 percent</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>npc_5percent <span class="ot">&lt;-</span> <span class="cn">NA</span> <span class="co">#Calculate the net present cost with a discount rate of 5 percent</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="b-incremental-analysis" class="level2">
<h2 class="anchored" data-anchor-id="b-incremental-analysis">2b Incremental analysis</h2>
<p>In this section, we’ll use lots of loops to conduct incremental analysis- the process of removing any dominated strategies and calculating the incremental cost-effectiveness ratios (ICERs) of the remaining non-dominated strategies. Coding this yourself should give you a strong understanding of the concept. Let’s get started!</p>
<p>First, I’ve written the code for you that reads in data on 9 different strategies we wish to compare. For each one, we have the estimated QALYs experienced and the estiamted cost to the insurer, the patient, and to productivity.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">#read table from Excel</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>t_CE <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">'params_assign1.xlsx'</span>, <span class="at">sheet =</span> <span class="st">"CEdata"</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Display it nicely</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>t_CE <span class="sc">|&gt;</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flextable</span>() <span class="sc">|&gt;</span> <span class="co">#turn into flextable object</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_box</span>() <span class="sc">|&gt;</span> <span class="co">#Apply a theme for aesthetics</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autofit</span>() <span class="co">#automatically set column widths to reasonable values</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="tabwid"><style>.cl-e5f4699e{}.cl-e5eeec30{font-family:'Helvetica';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-e5eeec3a{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-e5f167c6{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-e5f167d0{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-e5f1745a{width:0.897in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e5f17464{width:0.795in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e5f17465{width:1.228in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e5f1746e{width:1.21in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e5f1746f{width:1.584in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e5f17470{width:0.897in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e5f17478{width:0.795in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e5f17479{width:1.228in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e5f17482{width:1.21in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e5f17483{width:1.584in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e5f1748c{width:0.897in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e5f1748d{width:0.795in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e5f1748e{width:1.228in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e5f17496{width:1.21in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e5f17497{width:1.584in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e5f174a0{width:0.897in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e5f174a1{width:0.795in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e5f174a2{width:1.228in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e5f174aa{width:1.21in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e5f174ab{width:1.584in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e5f174ac{width:0.897in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e5f174b4{width:0.795in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e5f174b5{width:1.228in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e5f174be{width:1.21in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e5f174bf{width:1.584in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table class="cl-e5f4699e"><thead><tr style="overflow-wrap:break-word;"><td class="cl-e5f1745a"><p class="cl-e5f167c6"><span class="cl-e5eeec30">Strategy</span></p></td><td class="cl-e5f17464"><p class="cl-e5f167d0"><span class="cl-e5eeec30">QALYs</span></p></td><td class="cl-e5f17465"><p class="cl-e5f167d0"><span class="cl-e5eeec30">Cost_insurer</span></p></td><td class="cl-e5f1746e"><p class="cl-e5f167d0"><span class="cl-e5eeec30">Cost_patient</span></p></td><td class="cl-e5f1746f"><p class="cl-e5f167d0"><span class="cl-e5eeec30">Cost_productivity</span></p></td></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-e5f17470"><p class="cl-e5f167c6"><span class="cl-e5eeec3a">G</span></p></td><td class="cl-e5f17478"><p class="cl-e5f167d0"><span class="cl-e5eeec3a">121</span></p></td><td class="cl-e5f17479"><p class="cl-e5f167d0"><span class="cl-e5eeec3a">11,000,000</span></p></td><td class="cl-e5f17482"><p class="cl-e5f167d0"><span class="cl-e5eeec3a">108,000</span></p></td><td class="cl-e5f17483"><p class="cl-e5f167d0"><span class="cl-e5eeec3a">131,890</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e5f1748c"><p class="cl-e5f167c6"><span class="cl-e5eeec3a">A</span></p></td><td class="cl-e5f1748d"><p class="cl-e5f167d0"><span class="cl-e5eeec3a">203</span></p></td><td class="cl-e5f1748e"><p class="cl-e5f167d0"><span class="cl-e5eeec3a">12,000,000</span></p></td><td class="cl-e5f17496"><p class="cl-e5f167d0"><span class="cl-e5eeec3a">1,080,000</span></p></td><td class="cl-e5f17497"><p class="cl-e5f167d0"><span class="cl-e5eeec3a">221,270</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e5f1748c"><p class="cl-e5f167c6"><span class="cl-e5eeec3a">B</span></p></td><td class="cl-e5f1748d"><p class="cl-e5f167d0"><span class="cl-e5eeec3a">304</span></p></td><td class="cl-e5f1748e"><p class="cl-e5f167d0"><span class="cl-e5eeec3a">74,700,000</span></p></td><td class="cl-e5f17496"><p class="cl-e5f167d0"><span class="cl-e5eeec3a">22,410,000</span></p></td><td class="cl-e5f17497"><p class="cl-e5f167d0"><span class="cl-e5eeec3a">307,040</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e5f174a0"><p class="cl-e5f167c6"><span class="cl-e5eeec3a">I</span></p></td><td class="cl-e5f174a1"><p class="cl-e5f167d0"><span class="cl-e5eeec3a">343</span></p></td><td class="cl-e5f174a2"><p class="cl-e5f167d0"><span class="cl-e5eeec3a">50,400,000</span></p></td><td class="cl-e5f174aa"><p class="cl-e5f167d0"><span class="cl-e5eeec3a">594,000</span></p></td><td class="cl-e5f174ab"><p class="cl-e5f167d0"><span class="cl-e5eeec3a">343,000</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e5f1748c"><p class="cl-e5f167c6"><span class="cl-e5eeec3a">E</span></p></td><td class="cl-e5f1748d"><p class="cl-e5f167d0"><span class="cl-e5eeec3a">503</span></p></td><td class="cl-e5f1748e"><p class="cl-e5f167d0"><span class="cl-e5eeec3a">41,400,000</span></p></td><td class="cl-e5f17496"><p class="cl-e5f167d0"><span class="cl-e5eeec3a">12,420,000</span></p></td><td class="cl-e5f17497"><p class="cl-e5f167d0"><span class="cl-e5eeec3a">482,880</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e5f174ac"><p class="cl-e5f167c6"><span class="cl-e5eeec3a">C</span></p></td><td class="cl-e5f174b4"><p class="cl-e5f167d0"><span class="cl-e5eeec3a">549</span></p></td><td class="cl-e5f174b5"><p class="cl-e5f167d0"><span class="cl-e5eeec3a">59,400,000</span></p></td><td class="cl-e5f174be"><p class="cl-e5f167d0"><span class="cl-e5eeec3a">6,480,000</span></p></td><td class="cl-e5f174bf"><p class="cl-e5f167d0"><span class="cl-e5eeec3a">510,570</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e5f174ac"><p class="cl-e5f167c6"><span class="cl-e5eeec3a">H</span></p></td><td class="cl-e5f174b4"><p class="cl-e5f167d0"><span class="cl-e5eeec3a">564</span></p></td><td class="cl-e5f174b5"><p class="cl-e5f167d0"><span class="cl-e5eeec3a">61,000,000</span></p></td><td class="cl-e5f174be"><p class="cl-e5f167d0"><span class="cl-e5eeec3a">2,376,000</span></p></td><td class="cl-e5f174bf"><p class="cl-e5f167d0"><span class="cl-e5eeec3a">541,440</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e5f174ac"><p class="cl-e5f167c6"><span class="cl-e5eeec3a">F</span></p></td><td class="cl-e5f174b4"><p class="cl-e5f167d0"><span class="cl-e5eeec3a">593</span></p></td><td class="cl-e5f174b5"><p class="cl-e5f167d0"><span class="cl-e5eeec3a">32,400,000</span></p></td><td class="cl-e5f174be"><p class="cl-e5f167d0"><span class="cl-e5eeec3a">8,100,000</span></p></td><td class="cl-e5f174bf"><p class="cl-e5f167d0"><span class="cl-e5eeec3a">539,630</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e5f174ac"><p class="cl-e5f167c6"><span class="cl-e5eeec3a">D</span></p></td><td class="cl-e5f174b4"><p class="cl-e5f167d0"><span class="cl-e5eeec3a">839</span></p></td><td class="cl-e5f174b5"><p class="cl-e5f167d0"><span class="cl-e5eeec3a">64,800,000</span></p></td><td class="cl-e5f174be"><p class="cl-e5f167d0"><span class="cl-e5eeec3a">11,088,000</span></p></td><td class="cl-e5f174bf"><p class="cl-e5f167d0"><span class="cl-e5eeec3a">864,170</span></p></td></tr></tbody></table></div>
</div>
</div>
<p>In this code chunk, you’ll calculate the cost-effectiveness from the insurer’s perspective (only including <code>Cost_insurer</code>). First, we detect any strategies that are dominated by strong dominance or extended dominance. Then, we calcualte the ICERs between all non-dominated interventions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Create table with columns "strategy", "QALYs", and "Cost", where cost is the Cost_insurer. We'll add two columns, one for whether the strategy is dominated and another for putting the ICERS for non-dominated interventions</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>t_CE_insurer <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Strategy =</span> t_CE<span class="sc">$</span>Strategy,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">QALYs =</span> t_CE<span class="sc">$</span>QALYs,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Cost =</span> t_CE<span class="sc">$</span>Cost_insurer,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Dominated =</span> <span class="st">"No"</span>,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">ICER =</span> <span class="fl">0.0</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co">#Sort t_CE_insurer ascending by QALYs (from low to high)</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="co">#t_CE_insurer &lt;- </span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>t_CE_insurer <span class="ot">&lt;-</span> t_CE_insurer[<span class="fu">order</span>(t_CE_insurer<span class="sc">$</span>QALYs), ]</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop over each row to determine if the strategy is dominated by strong dominance. </span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="co"># If so, replace the value in the 'Dominated' column with 'Strong'</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">nrow</span>(t_CE_insurer) <span class="sc">-</span> <span class="dv">1</span>)){</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Compare the cost in row (i+1) to the current row.</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>  <span class="co">#  write "Strong" in the dominated column if applicable</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (t_CE_insurer[i<span class="sc">+</span><span class="dv">1</span>, <span class="st">"Cost"</span>] <span class="sc">&lt;</span> t_CE_insurer[i, <span class="st">"Cost"</span>]){</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>    t_CE_insurer[i, <span class="st">"Dominated"</span>] <span class="ot">&lt;-</span> <span class="st">"Strong"</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop over each non-dominated strategy to determine if the strategy is dominated by extended dominance. </span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a><span class="co"># If so, replace the value in the 'Dominated' column with 'Extended'.</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a><span class="co">#Note: For extended dominance, we need to keep looping until we </span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a><span class="co"># do a pass without identifying any dominates interventions</span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>stop <span class="ot">=</span> T <span class="co">#Stop looping; set to false if we find any dominated interventions</span></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span>(stop<span class="sc">==</span>F){</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Get the row index for all rows that aren't dominated</span></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>  idx_nondom_rows <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">rownames</span>(t_CE_insurer[t_CE_insurer<span class="sc">$</span>Dominated<span class="sc">==</span><span class="st">"No"</span>,]))</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Get number of nondom rows</span></span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>  n_nondom <span class="ot">&lt;-</span> <span class="fu">length</span>(idx_nondom_rows)</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>(n_nondom <span class="sc">-</span> <span class="dv">1</span>)){</span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Compute ICER compared to last non-dominated strategy</span></span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>    <span class="co">#If ICER this strategy &gt; ICER last strategy, last strategy extended dominated</span></span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a><span class="co">#Calculate ICERs between </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="identifying-maximum-net-monetary-benefit" class="level2">
<h2 class="anchored" data-anchor-id="identifying-maximum-net-monetary-benefit">Identifying maximum net monetary benefit</h2>
<p>Calculate NBM at a range of WTP thresholds and then plot</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>